import{_ as p}from"./chunks/ArticleMetadata.MPwIUJhD.js";import{_ as d,m as i,a as k,e as r,x as s,u as n,B as m,ah as u,o,p as g,q as f}from"./chunks/framework.BuAcqOzq.js";import"./chunks/theme.COI_me25.js";const R=JSON.parse('{"title":"Kafka Concepts","description":"","frontmatter":{"title":"Kafka Concepts","author":"ChocolateAceCream","date":"2024/09/21 19:00","isTop":false,"categories":["backend"],"tags":["Kafka"]},"headers":[],"relativePath":"categories/backend/2024/09/21/Kafka_Basic.md","filePath":"categories/backend/2024/09/21/Kafka_Basic.md","lastUpdated":1742929213000}'),b={name:"categories/backend/2024/09/21/Kafka_Basic.md"},y={id:"kafka-concepts",tabindex:"-1"},_=r("a",{class:"header-anchor",href:"#kafka-concepts","aria-label":'Permalink to "Kafka Concepts <Badge text="Kafka" type="warning" />"'},"​",-1),w=u(`<h2 id="topics" tabindex="-1">Topics <a class="header-anchor" href="#topics" aria-label="Permalink to &quot;Topics&quot;">​</a></h2><ul><li>Producer write data to topics and consumer read data from topics</li><li>Multiple consumers can subscribe to the same topic and receive the data</li></ul><h2 id="partition" tabindex="-1">Partition <a class="header-anchor" href="#partition" aria-label="Permalink to &quot;Partition&quot;">​</a></h2><p>Subdivision of a topic. Each topic consist of one or more partitions, in each partition, the message is guaranteed to be consumed in FIFO order.</p><h2 id="key" tabindex="-1">Key <a class="header-anchor" href="#key" aria-label="Permalink to &quot;Key&quot;">​</a></h2><p>each message can have a key of any []byte type, this key is used for partition the message (using hash of the key to determine the partition if no partition was given). If no key is given, then message is assigned to partition using default hashing method</p><h2 id="value" tabindex="-1">Value <a class="header-anchor" href="#value" aria-label="Permalink to &quot;Value&quot;">​</a></h2><p>Can be any format that parsed into []byte.</p><h2 id="in-sync-replicas-isr" tabindex="-1">In-Sync Replicas(ISR) <a class="header-anchor" href="#in-sync-replicas-isr" aria-label="Permalink to &quot;In-Sync Replicas(ISR)&quot;">​</a></h2><p>the broker that are:</p><ul><li>fully up-to-date with partition&#39;s leader</li><li>alive and replicating without lag beyond threshold</li></ul><p>common setting is</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">ack</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">all</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># Wait for all ISR (In-Sync Replicas) of the partition to confirm the write before ACKing the producer</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">min.insync.replicas</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">=2</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"># Only allow writes if at least 2 brokers (including leader) are in the In-Sync Replicas (ISR) set</span></span></code></pre></div><p>So once producer send message to broker, the leader broker will sync message in background in parallel to all the ISRs and wait for ack back. if not enough ack (less than the min.insync.replicas), the write is rejected, msg was marked as uncomitted, so it can be GC or rolled back during failover. If has enough acks back, then msg was marked as committed and included in High Watermark</p><p>p.s. when counting ISRs, leader broker itself is always counted as ISR</p><h2 id="high-watermark" tabindex="-1">High Watermark <a class="header-anchor" href="#high-watermark" aria-label="Permalink to &quot;High Watermark&quot;">​</a></h2><p>The high watermark is the offset of the last committed message in kafka partition A message is committed if it has been</p><ul><li>written to the leader</li><li>replicated to all required ISRs (&gt;=min.insync.replicas)</li></ul><p>p.s. <em><strong>consumers only see messages up to the HW.</strong></em></p>`,19);function C(a,S,v,I,q,K){const l=i("Badge"),c=p,h=i("ClientOnly");return o(),k("div",null,[r("h1",y,[s("Kafka Concepts "),n(l,{text:"Kafka",type:"warning"}),s(),_]),n(h,null,{default:m(()=>{var e,t;return[(((e=a.$frontmatter)==null?void 0:e.aside)??!0)&&(((t=a.$frontmatter)==null?void 0:t.showArticleMetadata)??!0)?(o(),g(c,{key:0,article:a.$frontmatter},null,8,["article"])):f("",!0)]}),_:1}),w])}const x=d(b,[["render",C]]);export{R as __pageData,x as default};
