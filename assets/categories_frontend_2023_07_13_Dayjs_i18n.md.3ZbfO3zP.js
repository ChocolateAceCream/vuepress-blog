import{_ as d}from"./chunks/ArticleMetadata.CsdLLuHv.js";import{_ as o,m as n,a as g,e as p,x as l,u as t,B as c,ah as y,o as e,p as A,q as D}from"./chunks/framework.BuAcqOzq.js";import"./chunks/theme.DVgIphpq.js";const w=JSON.parse('{"title":"Dayjs i18n","description":"","frontmatter":{"title":"Dayjs i18n","author":"ChocolateAceCream","date":"2023/07/13 19:00","isTop":false,"categories":["frontend"],"tags":["Dayjs","i18n","Vue3"]},"headers":[],"relativePath":"categories/frontend/2023/07/13/Dayjs_i18n.md","filePath":"categories/frontend/2023/07/13/Dayjs_i18n.md","lastUpdated":1714672867000}'),C={name:"categories/frontend/2023/07/13/Dayjs_i18n.md"},B={id:"dayjs-i18n-setting-in-vue3",tabindex:"-1"},F=p("a",{class:"header-anchor",href:"#dayjs-i18n-setting-in-vue3","aria-label":'Permalink to "Dayjs i18n setting in vue3 <Badge text="Dayjs" type="warning" />"'},"​",-1),u=y(`<h3 id="purpose" tabindex="-1">purpose: <a class="header-anchor" href="#purpose" aria-label="Permalink to &quot;purpose:&quot;">​</a></h3><p>Import dayjs as a global instance and switching its locale according to user setting in a vue3 app</p><ol><li>install dayjs</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> install</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> dayjs</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> --save</span></span></code></pre></div><ol start="2"><li>import dayjs in main.js</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> dayjs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;dayjs&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#768390;">// or import { dayjs } from &#39;element-plus&#39; is you using element-plus</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> relativeTime </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> &#39;dayjs/plugin/relativeTime&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#768390;"> // dayjs plugin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> createApp</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(App)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">dayjs.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">extend</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(relativeTime)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">app.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">provide</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;dayjs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">, dayjs)</span></span></code></pre></div><ol start="3"><li>usage in vue3 file</li></ol><div class="language-js vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> default</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> defineComponent</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">  setup</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">props</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#F69D50;">ctx</span><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">) </span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> dayjs</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">&#39;dayjs&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    const</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;"> state</span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> reactive</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      timestamp: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">computed</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(() </span><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">        return</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;"> dayjs</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(state.articleInfo.updatedAt).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">fromNow</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    })</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">      ...</span><span style="--shiki-light:#6F42C1;--shiki-dark:#DCBDFB;">toRefs</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">(state)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F69D50;">})</span></span></code></pre></div><ol start="4"><li>i18n setting for dayjs in App.vue According to dayjs documentation:</li></ol><blockquote><ul><li>By default, Day.js comes with English locale only.</li><li>Once you load a locale, it becomes the active locale. To change active locales, simply call dayjs.locale with the key of a loaded locale to change global locale.</li><li>Changing the global locale doesn&#39;t affect existing instances.</li></ul></blockquote><p>In order to see the change for existing dayjs instance, we need to reload the page, so we first implement a reload() in app.vue and then call that method for each time user switch a locale</p><div class="language-vue vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">vue</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">// App.vue</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">el-config-provider</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6CB6FF;">locale</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">locale</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6CB6FF;">size</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;">\`default\`</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6CB6FF;">z-index</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#6CB6FF;">3000</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  &gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    &lt;</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">router-view</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F47067;">      v-if</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">isRouterAlive</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      :</span><span style="--shiki-light:#6F42C1;--shiki-dark:#6CB6FF;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">$route.fullPath</span><span style="--shiki-light:#032F62;--shiki-dark:#ADBAC7;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    /&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  &lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">el-config-provider</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&lt;/</span><span style="--shiki-light:#22863A;--shiki-dark:#8DDB8C;">template</span><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">import &#39;dayjs/locale/zh-cn&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">export default defineComponent({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  setup(props, ctx) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    const dayjs = inject(&#39;dayjs&#39;)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    const dayjsLocaleMapper = {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      &#39;cn&#39;: &#39;zh-cn&#39;,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      &#39;en&#39;: &#39;en&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    const state = reactive({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      locale: zhCn,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      isRouterAlive: true,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    const store = useSessionStore()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    store.$subscribe(async(_, s) =&gt; {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      dayjs.locale(dayjsLocaleMapper[s.userInfo.locale])</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      reload()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    })</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    return {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">      ...toRefs(state)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#ADBAC7;">})</span></span></code></pre></div>`,12);function E(s,m,v,f,j,_){const h=n("Badge"),k=d,r=n("ClientOnly");return e(),g("div",null,[p("h1",B,[l("Dayjs i18n setting in vue3 "),t(h,{text:"Dayjs",type:"warning"}),l(),F]),t(r,null,{default:c(()=>{var i,a;return[(((i=s.$frontmatter)==null?void 0:i.aside)??!0)&&(((a=s.$frontmatter)==null?void 0:a.showArticleMetadata)??!0)?(e(),A(k,{key:0,article:s.$frontmatter},null,8,["article"])):D("",!0)]}),_:1}),u])}const T=o(C,[["render",E]]);export{w as __pageData,T as default};
