import{_ as h}from"./chunks/ArticleMetadata.FYFY5EUu.js";import{_ as p,m as s,a as u,e as r,x as o,u as n,B as g,ah as k,o as i,p as f,q as m}from"./chunks/framework.BuAcqOzq.js";import"./chunks/theme.BKdK5HF4.js";const P=JSON.parse('{"title":"GO SDK","description":"","frontmatter":{"title":"GO SDK","author":"ChocolateAceCream","date":"2024/10/19 16:25","categories":["AWS"],"tags":["AWS","Go","S3"]},"headers":[],"relativePath":"courses/AWS/04-GoSDK/01-GoSDK.md","filePath":"courses/AWS/04-GoSDK/01-GoSDK.md","lastUpdated":1731609247000}'),b={name:"courses/AWS/04-GoSDK/01-GoSDK.md"},_={id:"go-sdk",tabindex:"-1"},y=r("a",{class:"header-anchor",href:"#go-sdk","aria-label":'Permalink to "GO SDK <Badge text="Go" type="warning" />"'},"​",-1),w=k(`<h2 id="install" tabindex="-1">install <a class="header-anchor" href="#install" aria-label="Permalink to &quot;install&quot;">​</a></h2><p>To use go sdk with aws, first install dependency and certain service api clients (s3 here for example)</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark-dimmed vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> github.com/aws/aws-sdk-go-v2</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> github.com/aws/aws-sdk-go-v2/config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#F69D50;">go</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> get</span><span style="--shiki-light:#032F62;--shiki-dark:#96D0FF;"> github.com/aws/aws-sdk-go-v2/service/s3</span></span></code></pre></div><h2 id="setup-credential" tabindex="-1">setup credential <a class="header-anchor" href="#setup-credential" aria-label="Permalink to &quot;setup credential&quot;">​</a></h2><p>you can config aws credential using aws cli</p><blockquote><p>aws config</p></blockquote><p>which will store access_key and secret in ~/.aws/config</p><p>Then your sdk will load the shared aws config from that dir</p><h2 id="case-study-generate-presigned-url-to-upload-to-s3-bucket" tabindex="-1">Case study: generate presigned url to upload to s3 bucket <a class="header-anchor" href="#case-study-generate-presigned-url-to-upload-to-s3-bucket" aria-label="Permalink to &quot;Case study: generate presigned url to upload to s3 bucket&quot;">​</a></h2><h3 id="why" tabindex="-1">Why? <a class="header-anchor" href="#why" aria-label="Permalink to &quot;Why?&quot;">​</a></h3><p>avoid traffic through backend server. generate a presigned url so frontend can direct upload/download files from s3 and files will not traffic through server.</p><h3 id="how" tabindex="-1">How <a class="header-anchor" href="#how" aria-label="Permalink to &quot;How&quot;">​</a></h3><ol><li>frontend use upload button to read file info, pass the filename to backend so backend can generate a endpoint using filename and username. Ideally, use username/filename to define the hierarchy of the bucket. (even though bucket does not have folder concept, we can still use / to simulate the folder for better access control purpose)</li><li>use go sdk to create s3 client, then generate presigned url and send back to frontend</li><li>frontend send put request with the file to the pre-signed url.</li></ol><p>P.S.1 enable CORS of bucket P.S.2 remember to create the bucket in your aws default region. Since when generate presigned url, default config is used (so default region is taken into effect) p.s.3 don&#39;t use session-id as part of the key since it may change frequently. A better approach is to generate a permanent &quot;folder&quot; name for each user to use the s3 bucket. p.s.4 when upload to s3, the response is only a http 200. p.s.5 the maximum size of single file upload to s3 using presigned url is 5GB. Use multipart presigned URLS for larger files</p>`,14);function S(e,F,D,v,q,C){const l=s("Badge"),d=h,c=s("ClientOnly");return i(),u("div",null,[r("h1",_,[o("GO SDK "),n(l,{text:"Go",type:"warning"}),o(),y]),n(c,null,{default:g(()=>{var a,t;return[(((a=e.$frontmatter)==null?void 0:a.aside)??!0)&&(((t=e.$frontmatter)==null?void 0:t.showArticleMetadata)??!0)?(i(),f(d,{key:0,article:e.$frontmatter},null,8,["article"])):m("",!0)]}),_:1}),w])}const K=p(b,[["render",S]]);export{P as __pageData,K as default};
